# PCコスパ分析 統合アプリ

データサイエンスの手法（主成分分析）を用いて、PCのスペック構成を可視化し、ユーザーの用途に合わせた最適なPC選択を支援するデスクトップアプリケーションです。

![Python](https://img.shields.io/badge/Python-3.10%2B-blue)
![PySide6](https://img.shields.io/badge/GUI-PySide6-green)
![License](https://img.shields.io/badge/License-MIT-yellow)

## 🌟 主な機能

### 1. **主成分分析 (PCA) による可視化**
- **動的な軸ラベル生成**: データの特性から自動的にPC1・PC2の意味を判定（例：「総合性能」vs「CPU重視 ↔ GPU重視」）
- **標準化PCA**: 各特徴量のスケールを揃えた上で主成分を抽出し、データの本質的な構造を可視化
- **多角的表示**: 点のサイズで「総合性能」、色で「価格」を表現し、一目でコスパが把握可能

### 2. **インタラクティブな推奨システム**
- **リアルタイム推奨**: スライダーを動かすと、即座に最適なPCが星マーク⭐で強調表示
- **予算フィルター**: 5万円〜100万円の範囲で予算上限を設定し、現実的な選択肢に絞り込み
- **適合スコア表示**: ユーザーの嗜好と各PCの相性を数値化して表示

### 3. **プリセット機能**
- **5つの用途別プリセット**:
  - 🔵 **プログラマー**: CPU・RAM重視（コンパイル・開発向け）
  - 🔴 **ゲーマー**: GPU・ストレージ重視（ゲーム向け）
  - 🟣 **動画編集者**: GPU・容量重視（動画編集向け）
  - 🟢 **一般ユーザー**: バランス型（一般用途）
  - 🟠 **AI・データ分析**: CPU重視（計算処理向け）
- ワンクリックで最適な重み設定を適用可能

### 4. **CSVデータ管理**
- アプリ内でPCデータの追加・削除・編集・保存が完結
- 既存CSVの読み込み・更新にも対応
- 前回使用したCSVを自動読み込み

### 5. **XAI（説明可能なAI）要素**
- 左パネルにPCA情報を常に表示（寄与率、累積寄与率、各スペックの寄与度）
- 右パネルに推奨PC詳細を大きく表示（価格、スペック、適合スコア）
- グラフ上の点をクリックすると詳細情報をポップアップ表示

## 🚀 セットアップ

### 1. 依存ライブラリのインストール
```bash
pip install -r requirements.txt
```

必要なパッケージ:
- PySide6
- numpy
- pandas
- scikit-learn
- matplotlib

### 2. アプリの起動
```bash
python pc_visualize_app.py
```

## 📊 分析の仕組み

### 1. **標準化PCA（Principal Component Analysis）**
- **標準化**: 各特徴量（CPU、GPU、RAM、SSD）のスケールを揃えるため、平均0・分散1に正規化
- **主成分抽出**: 
  - **PC1**: 通常は全特徴量の総合力を表す軸（総合性能）
  - **PC2**: 特徴量間の対立軸を表す軸（例：GPU重視 ↔ CPU重視）
- **動的ラベリング**: 固有ベクトルの寄与度から、各主成分が何を意味するかを自動判定

### 2. **嗜好ベクトルによるスコアリング**
- ユーザーが設定した重み（構成バランス）をPCA空間上のベクトルとして扱う
- 各PCの座標と嗜好ベクトルの類似度を計算し、適合スコアを算出
- スコア計算式: `0.5 × (PC1の正規化値) + 0.5 × (構成バランス重み × PC2の正規化値)`

### 3. **予算フィルタリング**
- 予算内のPCのみを対象にスコア計算を実施
- 予算内にPCがない場合は、全PCから最適なものを提示（予算外として明示）

## 🎨 画面構成

### 左パネル（PCA情報）
- PC1・PC2の寄与率と累積寄与率をプログレスバーで視覚化
- 各スペック（CPU、GPU、RAM、SSD）の寄与度テーブル

### 中央パネル（グラフ）
- PCA空間上にPCをプロット
- 推奨PCを⭐マークで強調表示
- 予算外のPCはグレーアウト

### 右パネル（推奨PC）
- 推奨PCのモデル名、価格、スペック、適合スコアを大きく表示
- 現在選択中のプリセットを表示

## 💡 使い方

1. **CSVタブ**でPCデータを管理（追加・編集・保存）
2. **コスパ分析タブ**で「このデータで分析」ボタンをクリック
3. プリセットボタンまたはスライダーで嗜好を調整
4. 推奨PCが右パネルに表示され、グラフ上でも⭐マークで強調
5. グラフ上の点をクリックすると詳細情報を確認可能

## 🛠 使用技術

- **Language**: Python 3.10+
- **GUI Framework**: PySide6 (Qt for Python)
- **Data Analysis**: scikit-learn (PCA), pandas, numpy
- **Visualization**: matplotlib
- **Data Management**: CSV

## 📂 ファイル構成

```
.
├── pc_visualize_app.py      # メインアプリケーション
├── pc_data.csv              # サンプルPCデータ
├── requirements.txt         # 依存ライブラリ一覧
├── README.md                # このファイル
└── last_csv_path.txt        # 前回使用したCSVパス（自動生成）
```

## 🔧 カスタマイズ

### フォントサイズの調整
[pc_visualize_app.py](pc_visualize_app.py) の78行目付近の `FONT_SCALE` を変更することで、全体のフォントサイズを調整できます。

```python
FONT_SCALE = 1.0  # 1.2にすると20%大きく、0.8にすると20%小さく
```

### プリセットの追加
[pc_visualize_app.py](pc_visualize_app.py) の32行目付近の `PRESETS` 辞書に新しいプリセットを追加できます。

```python
PRESETS = {
    "新プリセット名": {
        "w_pc2": 50,  # -100〜100の範囲でバランス調整
        "color": "#FF5722",  # ボタンの色（16進数カラーコード）
        "description": "説明文"
    },
    # ...
}
```

## 📝 ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。

## 🤝 貢献

バグ報告や機能提案は Issue でお願いします。プルリクエストも歓迎します！
